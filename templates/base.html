<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Maihlili Paie</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'maihlili': {
              50: '#E6E9FF',
              100: '#C8CEFF', 
              200: '#AAAEFF',
              300: '#8C8FFF',
              400: '#6E71FF',
              500: '#3055ff', // Bleu principal
              600: '#2A4CE5', 
              700: '#2343CC',
              800: '#1D3AAA',
              900: '#163188'
            },
            // Couleurs sp√©cifiques demand√©es par le Figma
            'fond-clair': '#FFF0F8', // Body clair
            'sidebar-clair': '#3055FF', // Sidebar claire
            'fond-sombre': '#1B1B1B', // Body sombre
            'sidebar-sombre': '#282828', // Sidebar sombre
            'carte-sombre': '#363636', // Carte/Panneau sombre
          }
        }
      }
    }
  </script>
  <style>
    /* -------------------------------------------------------------------------------------------------- */
    /* STYLES GLOBALES & COULEURS STRICTEMENT BAS√âES SUR VOTRE FIGMA                                       */
    /* -------------------------------------------------------------------------------------------------- */
    :root {
      /* Couleurs Claires (PAGE 2) */
      --color-bg-light: #FFF0F8; 
      --color-sidebar-bg-light: #3055FF; 
      --color-card-bg-light: #FFFFFF;
      --color-text-light: #181818;
      --color-border-light: #E0E0E0;

      /* Couleurs Sidebar Claires */
      --color-sidebar-text-light: #FFFFFF; 
      --color-sidebar-link-hover-light: #456BFF; 
      --color-sidebar-link-active-bg-light: #FFFFFF; 
      --color-sidebar-link-active-text-light: #3055FF;
    }

    [data-theme="dark"] {
      /* Couleurs Sombres (PAGE 4) */
      --color-bg-dark: #1B1B1B; 
      --color-sidebar-bg-dark: #282828; 
      --color-card-bg-dark: #363636; 
      --color-text-dark: #F5F5F5;
      --color-border-dark: #454545;
      --color-input-bg-dark: #454545; 

      /* Couleurs Sidebar Sombres */
      --color-sidebar-text-dark: #F5F5F5; 
      --color-sidebar-link-hover-dark: #363636; 
      --color-sidebar-link-active-bg-dark: #363636; 
      --color-sidebar-link-active-text-dark: #FFFFFF;
    }

    body {
      background-color: var(--color-bg-light);
      color: var(--color-text-light);
      transition: background-color 0.3s, color 0.3s;
    }
    
    [data-theme="dark"] body {
      background-color: var(--color-bg-dark);
      color: var(--color-text-dark);
    }

    /* 1. Sidebar */
    aside {
        background-color: var(--color-sidebar-bg-light);
        border-right: none; 
        transition: background-color 0.3s;
        color: var(--color-sidebar-text-light); 
    }

    [data-theme="dark"] aside {
        background-color: var(--color-sidebar-bg-dark);
        color: var(--color-sidebar-text-dark);
        border-right-color: var(--color-border-dark);
    }
    
    /* 2. Cartes (Cards) & Conteneurs */
    .card, .bg-white {
        background-color: var(--color-card-bg-light) !important;
        border: 1px solid var(--color-border-light) !important;
        border-radius: 1rem; 
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05) !important;
        transition: background-color 0.3s, border-color 0.3s;
    }

    [data-theme="dark"] .card,
    [data-theme="dark"] .bg-white {
        background-color: var(--color-card-bg-dark) !important;
        border-color: var(--color-border-dark) !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4) !important;
    }
    
    /* 3. Navigation Links DANS LA SIDEBAR */
    aside .nav-link {
        padding: 0.75rem; 
        border-radius: 0.75rem; 
        transition: all 0.2s;
        /* D√©faut clair */
        color: var(--color-sidebar-text-light) !important;
    }
    
    aside .nav-link:hover {
        background-color: var(--color-sidebar-link-hover-light) !important;
    }
    
    /* Lien Actif Clair */
    aside .nav-link.active {
        background-color: var(--color-sidebar-link-active-bg-light) !important; /* Blanc */
        color: var(--color-sidebar-link-active-text-light) !important; /* Bleu Vif */
        font-weight: 600;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    /* Lien Actif Sombre */
    [data-theme="dark"] aside .nav-link {
        color: var(--color-sidebar-text-dark) !important; 
    }
    [data-theme="dark"] aside .nav-link:hover {
        background-color: var(--color-sidebar-link-hover-dark) !important; 
    }
    [data-theme="dark"] aside .nav-link.active {
        background-color: var(--color-sidebar-link-active-bg-dark) !important; /* Gris moyen */
        color: var(--color-sidebar-link-active-text-dark) !important; /* Blanc */
        box-shadow: none;
    }
    
    /* 4. Textes et Bordures du Main Content (hors Sidebar) */
    [data-theme="dark"] .text-gray-800 { color: var(--color-text-dark) !important; }
    [data-theme="dark"] .text-gray-500 { color: var(--color-border-dark) !important; }
    [data-theme="dark"] .border-gray-200,
    [data-theme="dark"] .border-t { border-color: var(--color-border-dark) !important; }
    
    /* 5. Input Fields pour le mode sombre */
    [data-theme="dark"] input, 
    [data-theme="dark"] select, 
    [data-theme="dark"] textarea {
      background-color: var(--color-input-bg-dark) !important;
      border-color: var(--color-border-dark) !important;
      color: var(--color-text-dark) !important;
    }
  </style>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.7/main.min.css" rel="stylesheet">
</head>
<body class="flex min-h-screen" data-theme="light">

  <aside class="w-64 min-h-screen flex flex-col p-4 shadow-xl">
    
    <div class="p-2 border-b border-gray-200 mb-6">
      <div class="flex items-center justify-center">
        <a href="{{ url_for('index') }}" class="flex items-center space-x-2">
          <img src="{{ url_for('static', filename='images/maihlili-logo-light.png') }}" alt="Logo Maihlili" class="h-10">
        </a>
      </div>
    </div>
    
    <nav class="flex-1 p-2 space-y-1">
      {% if current_user.is_authenticated %}
        <a href="{{ url_for('index') if current_user.is_manager else url_for('employee_dashboard') }}" 
           class="nav-link flex items-center gap-3 font-medium">
           <span class="text-lg">üìä</span> Tableau de bord
        </a>
         {% if current_user.is_manager %}
          <a href="{{ url_for('planning') }}" 
             class="nav-link flex items-center gap-3 font-medium">
            <span class="text-lg">üìÖ</span> Planning
          </a>
          
          <a href="{{ url_for('show_employees') }}" 
             class="nav-link flex items-center gap-3 font-medium">
            <span class="text-lg">üë•</span> Employ√©s
          </a>
          <a href="{{ url_for('manage_teams') }}" 
             class="nav-link flex items-center gap-3 font-medium">
            <span class="text-lg">üè¢</span> √âquipes
          </a>
          <a href="{{ url_for('show_shifts') }}" 
             class="nav-link flex items-center gap-3 font-medium">
            <span class="text-lg">üïê</span> Services
          </a>
          <a href="{{ url_for('assignments') }}" 
             class="nav-link flex items-center gap-3 font-medium">
            <span class="text-lg">üìã</span> Assignations
          </a>
        {% endif %}
        <a href="{{ url_for('settings') }}" 
           class="nav-link flex items-center gap-3 font-medium">
          <span class="text-lg">‚öôÔ∏è</span> Param√®tres
        </a>
      {% else %}
        <a href="{{ url_for('login') }}" 
           class="nav-link flex items-center gap-3 font-medium">
          <span class="text-lg">üîë</span> Connexion
        </a>
        <a href="{{ url_for('register') }}" 
           class="nav-link flex items-center gap-3 font-medium">
          <span class="text-lg">üìù</span> Inscription
        </a>
      {% endif %}
    </nav>

    {% if current_user.is_authenticated %}
    <div class="p-2 border-t border-gray-200 mt-auto">
      <div class="user-profile flex items-center gap-3 p-3 rounded-xl card bg-white !border-none">
        <div class="w-10 h-10 bg-maihlili-500 rounded-full flex items-center justify-center text-white text-sm font-bold">
          {{ current_user.username[0].upper() }}
        </div>
        <div class="flex-1">
          <p class="text-sm font-semibold text-gray-800">{{ current_user.username }}</p>
          <p class="text-xs text-gray-500">
            {% if current_user.is_admin %}‚ö° Administrateur
            {% elif current_user.is_manager %}üëë Manager
            {% else %}üë§ Employ√©{% endif %}
          </p>
        </div>
      </div>
      <a href="{{ url_for('logout') }}" 
         class="nav-link flex items-center gap-3 p-2 rounded-lg text-sm mt-3 font-medium">
        <span class="text-base">üö™</span> D√©connexion
      </a>
    </div>
    {% endif %}
  </aside>

  <main class="flex-1 p-8">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-6 space-y-3">
            {% for category, message in messages %}
                <div class="flash-message border-l-4 border-maihlili-500 p-4 rounded-xl shadow-sm bg-white" role="alert">
                    <p class="font-medium text-maihlili-700">{{ message }}</p>
                </div>
            {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <button class="theme-toggle fixed bottom-6 right-6 p-4 rounded-full text-2xl cursor-pointer shadow-lg z-50 transition-all duration-300 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300" id="themeToggle">
    üåô
  </button>

  <script>
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    
    // R√©cup√©rer le th√®me sauvegard√©
    const savedTheme = localStorage.getItem('maihlili-theme') || 'light';
    body.setAttribute('data-theme', savedTheme);
    updateThemeToggle(savedTheme);
    
    function toggleTheme() {
      const currentTheme = body.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      body.setAttribute('data-theme', newTheme);
      localStorage.setItem('maihlili-theme', newTheme);
      updateThemeToggle(newTheme);
    }
    
    function updateThemeToggle(theme) {
      if (theme === 'light') {
        themeToggle.textContent = 'üåô';
        themeToggle.title = 'Passer en mode sombre';
        // Style pour le mode clair
        themeToggle.className = 'theme-toggle fixed bottom-6 right-6 p-4 rounded-full text-2xl cursor-pointer shadow-lg z-50 transition-all duration-300 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300';
      } else {
        themeToggle.textContent = '‚òÄÔ∏è';
        themeToggle.title = 'Passer en mode clair';
        // Style pour le mode sombre (bouton accentu√©)
        themeToggle.className = 'theme-toggle fixed bottom-6 right-6 p-4 rounded-full text-2xl cursor-pointer shadow-lg z-50 transition-all duration-300 ease-in-out bg-maihlili-500 text-white hover:bg-maihlili-600';
      }
    }

    themeToggle.addEventListener('click', toggleTheme);

    document.addEventListener('DOMContentLoaded', function() {
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('.nav-link');
      
      navLinks.forEach(link => {
        link.classList.remove('active');

        if (link.getAttribute('href') === currentPath) {
          link.classList.add('active');
        }
      });
    });
  </script>
</body>
</html>
